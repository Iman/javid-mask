<div dir="rtl" lang="fa">

# سیفتر - دروازه حفاظت DNS

<div dir="ltr">

**[English](README.md)** | **[فارسی](README.fa.md)**

</div>

یک دروازه حفاظت هویت سبک مبتنی بر DNS با استفاده از رزبری پای. سیفتر دامنه‌ها و IPهای ایرانی را در سطح شبکه مسدود می‌کند و از حملات همبستگی هویت برای کاربران استارلینک در ایران جلوگیری می‌کند.

**نویسنده:** ایمان سمیع‌زاده
**مجوز:** MIT
**مخزن:** https://github.com/Iman/javid-mask
**آخرین بروزرسانی:** ۱۴۰۴/۱۱/۱۲

---

## فهرست مطالب

- [خلاصه اجرایی](#خلاصه-اجرایی)
- [حمله همبستگی هویت](#حمله-همبستگی-هویت)
- [معماری](#معماری)
- [ویژگی‌ها](#ویژگی‌ها)
- [خلاصه حفاظت از نشت](#خلاصه-حفاظت-از-نشت)
- [پیش‌نیازها](#پیش‌نیازها)
- [شروع سریع](#شروع-سریع)
- [پیکربندی](#پیکربندی)
- [تنظیم دستگاه‌ها](#تنظیم-دستگاه‌ها)
- [راهنمای سخت‌سازی مرورگر](#راهنمای-سخت‌سازی-مرورگر)
- [مقایسه MikroTik و رزبری پای](#مقایسه-mikrotik-و-رزبری-پای)
- [عیب‌یابی](#عیب‌یابی)
- [نگهداری](#نگهداری)
- [مجوز](#مجوز)

---

## نمودارهای معماری

### معماری شبکه

![معماری شبکه سیفتر](diagrams/network-architecture.drawio.png)

### حفاظت از نشت

![حفاظت از نشت سیفتر](diagrams/leak-protection.drawio.png)

---

## خلاصه اجرایی

**سیفتر** ساده‌ترین معماری در پروژه javid-mask است. این معماری فراهم می‌کند:

- **فیلترینگ سطح DNS** با Pi-hole که بیش از ۱.۶ میلیون دامنه مخرب را مسدود می‌کند
- **مسدودسازی دامنه ایرانی** با بیش از ۱۳۱,۵۷۶ دامنه از مخزن bootmortis
- **مسدودسازی IP ایرانی** با ۷۶۳ رنج CIDR از طریق nftables
- **DNS رمزشده** از طریق DNS-over-HTTPS به Cloudflare
- **جلوگیری از نشت IPv6** با غیرفعال‌سازی کامل IPv6

برخلاف سینگلتون (WiFi AP + پراکسی) یا مثلث (WiFi AP + WireGuard VPN)، سیفتر یک سرور DNS خالص است. شما به سادگی تنظیمات DNS دستگاه‌هایتان را به رزبری پای هدایت می‌کنید و تمام کوئری‌های DNS فیلتر و رمزگذاری می‌شوند.

**از سیفتر استفاده کنید وقتی:**
- ساده‌ترین حفاظت ممکن را می‌خواهید
- نیازی به شبکه WiFi جداگانه ندارید
- می‌خواهید تمام دستگاه‌های شبکه موجودتان را محافظت کنید
- مسدودسازی سطح DNS برای مدل تهدید شما کافی است

---

## حمله همبستگی هویت

### چرا این پروژه وجود دارد

وقتی یک کاربر استارلینک در ایران به‌طور تصادفی از یک وب‌سایت ایرانی بازدید می‌کند، هویت او می‌تواند از طریق کوکی‌ها، فینگرپرینت مرورگر یا جلسات ورود همبسته شود:

<div dir="ltr">

```
قبل (ISP معمولی ایرانی):
┌──────────────┐      ┌─────────────────┐
│ کاربر        │─────►│ وب‌سایت ایرانی  │
│ کوکی: رضا    │      │ (digikala.com)  │
│ IP: ایران    │      │ لاگ: رضا=ایران  │
└──────────────┘      └─────────────────┘

بعد (استارلینک - خطرناک):
┌──────────────┐      ┌─────────────────┐
│ کاربر        │─────►│ وب‌سایت ایرانی  │
│ کوکی: رضا    │      │ (digikala.com)  │
│ IP: آمریکا!  │      │ لاگ: رضا=آمریکا!│  ◄── پرچم قرمز
└──────────────┘      └─────────────────┘       "رضا استارلینک دارد"
```

</div>

### بردارهای حمله

| بردار | ریسک | دفاع سیفتر |
|-------|------|------------|
| کوکی‌ها | سایت ایرانی کاربر بازگشتی را شناسایی می‌کند | مسدودسازی دامنه = بدون اتصال |
| فینگرپرینت مرورگر | Canvas، WebGL دستگاه را شناسایی می‌کنند | مسدودسازی دامنه = فینگرپرینت ارسال نمی‌شود |
| کوئری DNS | کوئری به DNS ایرانی قصد را فاش می‌کند | مسدودسازی در سطح DNS |
| IP مستقیم | Analytics، CDN، محتوای تعبیه‌شده | مسدودسازی تمام رنج‌های IP ایرانی |
| جلسه ورود | جلسه احراز هویت شده هویت را فاش می‌کند | نمی‌تواند به سرور ورود برسد |

### دفاع سیفتر

سیفتر اتصال به سرورهای ایرانی را در دو سطح کاملاً مسدود می‌کند:

۱. **سطح DNS**: Pi-hole برای بیش از ۱۳۱,۵۷۶ دامنه ایرانی `0.0.0.0` برمی‌گرداند
۲. **سطح IP**: nftables بسته‌ها را به ۷۶۳ رنج CIDR ایرانی DROP می‌کند

نتیجه: دستگاه شما نمی‌تواند به سرورهای ایرانی متصل شود، بنابراین کوکی‌ها/فینگرپرینت‌ها/هویت نمی‌توانند نشت کنند.

---

## معماری

### توپولوژی شبکه

<div dir="ltr">

```
                    ┌─────────────────────┐
                    │     INTERNET        │
                    └──────────┬──────────┘
                               │
                    ┌──────────▼──────────┐
                    │  STARLINK TERMINAL  │
                    │   (یا هر روتری)     │
                    └──────────┬──────────┘
                               │
                    ┌──────────▼──────────┐
                    │   HOME ROUTER       │
                    │   LAN: 10.0.0.1     │
                    └──────────┬──────────┘
                               │
          ┌────────────────────┼────────────────────┐
          │                    │                    │
┌─────────▼─────────┐ ┌────────▼────────┐ ┌────────▼────────┐
│   RASPBERRY PI    │ │   گوشی شما      │ │   لپ‌تاپ شما   │
│   SIFTER DNS      │ │   DNS: IP پای   │ │   DNS: IP پای   │
│   10.0.0.242      │ │                 │ │                 │
│                   │ │                 │ │                 │
│   سرویس‌ها:       │ └─────────────────┘ └─────────────────┘
│   • Pi-hole       │
│   • Cloudflared   │   تمام دستگاه‌ها از پای به عنوان سرور DNS استفاده می‌کنند
│   • nftables      │   تمام کوئری‌های DNS فیلتر و رمزگذاری می‌شوند
└───────────────────┘
```

</div>

### چگونه کار می‌کند

۱. **دستگاه کوئری DNS ارسال می‌کند** → `digikala.com`
۲. **Pi-hole کوئری را دریافت می‌کند** → لیست مسدودی (بیش از ۱۳۱ هزار دامنه ایرانی) را بررسی می‌کند
۳. **اگر مسدود باشد** → `0.0.0.0` برمی‌گرداند (اتصال رد شد)
۴. **اگر مجاز باشد** → به Cloudflared (DoH) فوروارد می‌کند
۵. **Cloudflared رمزگذاری می‌کند** → از طریق HTTPS به Cloudflare 1.1.1.1 ارسال می‌کند
۶. **ISP نمی‌تواند ببیند** → کوئری‌های DNS شما رمزگذاری شده‌اند

### آنچه سیفتر انجام نمی‌دهد

| ویژگی | سیفتر | سینگلتون | مثلث |
|-------|-------|----------|------|
| فیلترینگ DNS | ✅ | ✅ | ✅ |
| مسدودسازی دامنه ایرانی | ✅ | ✅ | ✅ |
| مسدودسازی IP ایرانی | ✅ | ✅ | ✅ |
| نقطه دسترسی WiFi | ❌ | ✅ | ✅ |
| پراکسی (VLESS/VMess) | ❌ | ✅ | ❌ |
| VPN (WireGuard) | ❌ | ❌ | ✅ |
| رمزگذاری ترافیک | ❌ | ✅ | ✅ |
| پوشش IP | ❌ | ❌ | ✅ |

سیفتر فقط DNS است. اتصالات را مسدود می‌کند اما ترافیک شما را رمزگذاری نمی‌کند (برای آن از HTTPS استفاده کنید) یا IP شما را مخفی نمی‌کند (برای آن از VPN/پراکسی استفاده کنید).

---

## ویژگی‌ها

### حفاظت DNS

- **Pi-hole v6**: بیش از ۱.۶ میلیون دامنه از بیش از ۱۷ لیست مسدودی مسدود شده
- **دامنه‌های ایرانی**: بیش از ۱۳۱,۵۷۶ از bootmortis/iran-hosted-domains
- **TLDهای ایرانی**: مسدودسازی Regex برای `*.ir`، `*.gov.ir`، `*.ac.ir` و غیره
- **DNSSEC**: تایید رمزنگاری پاسخ‌های DNS
- **محدودسازی نرخ**: ۱۰۰۰ کوئری/۶۰ ثانیه برای هر کلاینت

### رمزگذاری DNS

- **Cloudflared**: پراکسی DNS-over-HTTPS
- **بالادست**: Cloudflare 1.1.1.1 (متمرکز بر حریم خصوصی)
- **کوری ISP**: ISP نمی‌تواند کوئری‌های DNS شما را ببیند
- **دور زدن بلاک‌ها**: حتی اگر ISP پورت ۵۳ را مسدود کند کار می‌کند

### حفاظت فایروال

- **مسدودسازی IP ایرانی**: ۷۶۳ رنج CIDR (nftables)
- **IPv6 غیرفعال**: DROP کامل تمام ترافیک IPv6
- **لاگ‌گیری**: تلاش‌های اتصال مسدود شده ثبت می‌شوند
- **بروزرسانی خودکار**: بروزرسانی روزانه لیست مسدودی IP

### لیست‌های مسدودی شامل

| دسته | منبع | دامنه‌ها | بروزرسانی |
|------|------|----------|-----------|
| میزبان‌های یکپارچه | StevenBlack/hosts | ۱۵۰,۰۰۰+ | روزانه |
| حریم خصوصی | EasyPrivacy | ۲۵,۰۰۰+ | هفتگی |
| تبلیغات | Prigent-Ads | ۵۰,۰۰۰+ | روزانه |
| فیشینگ | Phishing Army | ۳۰,۰۰۰+ | ساعتی |
| بدافزار | Malware Domains | ۲۰,۰۰۰+ | روزانه |
| دامنه‌های ایرانی | bootmortis/iran-hosted-domains | ۱۳۱,۵۷۶+ | هفتگی |

---

## خلاصه حفاظت از نشت

### وضعیت حفاظت فرضا

| نوع نشت | وضعیت حفاظت | پیاده‌سازی |
|---------|-------------|------------|
| **نشت DNS** | ✅ محافظت شده | Pi-hole → Cloudflared DoH (رمزشده) |
| **نشت IPv6** | ✅ محافظت شده | IPv6 به‌طور کامل در nftables غیرفعال (DROP تمام ip6) |
| **نشت دامنه ایرانی** | ✅ محافظت شده | بیش از ۱۳۱,۵۷۶ دامنه در سطح DNS مسدود |
| **نشت IP ایرانی** | ✅ محافظت شده | ۷۶۳ رنج CIDR در سطح فایروال مسدود |
| **همبستگی کوکی** | ✅ محافظت شده | نمی‌تواند به سرورهای ایرانی متصل شود = بدون نشت کوکی |
| **نشت WebRTC** | ⚠️ نیاز به تنظیم مرورگر | سطح شبکه نمی‌تواند مسدود کند؛ مرورگر را پیکربندی کنید |
| **فینگرپرینت مرورگر** | ⚠️ نیاز به تنظیم مرورگر | سطح شبکه نمی‌تواند مسدود کند؛ مرورگر را پیکربندی کنید |

### حفاظت شبکه در مقابل مرورگر

<div dir="ltr">

```
NETWORK LEVEL (✅ خودکار توسط سیفتر):
├── DNS queries → Pi-hole → Cloudflared DoH (رمزشده)
├── IPv6 traffic → DROP (nftables ip6 filter)
├── Iranian IPs → DROP (nftables, 763 رنج CIDR)
└── Iranian domains → 0.0.0.0 (Pi-hole, 131,576+ دامنه)

BROWSER LEVEL (⚠️ کاربر باید پیکربندی کند):
├── WebRTC → غیرفعال در تنظیمات مرورگر
├── JavaScript fingerprinting → استفاده از uBlock Origin, NoScript
├── Canvas fingerprinting → Firefox resistFingerprinting
└── Cookie tracking → استفاده از افزونه Cookie AutoDelete
```

</div>

---

## پیش‌نیازها

### نیازمندی‌های سخت‌افزاری

| جزء | حداقل | پیشنهادی | یادداشت |
|-----|-------|----------|---------|
| رزبری پای | Pi 3B+ | Pi 5 (4GB) | Pi 5 به طور قابل توجهی سریع‌تر |
| کارت MicroSD | 16GB Class 10 | 32GB A2 | رتبه A2 برای I/O تصادفی بهتر |
| اترنت | 100Mbps | 1Gbps | گیگابیت برای سرعت کامل استارلینک |
| منبع تغذیه | 5V 2.5A | 5V 5A (Pi 5) | PSU رسمی پیشنهاد می‌شود |

### نرم‌افزار روی رزبری پای

- **سیستم عامل**: Raspberry Pi OS (Debian 13 "Trixie" یا جدیدتر)
- **SSH**: فعال شده با حساب کاربری (مثلاً `admin`)
- **دسترسی Sudo**: کاربر باید sudo بدون رمز داشته باشد
- **شبکه**: IP ثابت یا رزرو DHCP (پیش‌فرض: 10.0.0.242)

### نرم‌افزار روی ماشین کنترل

- **سیستم عامل**: macOS، Linux یا Windows (WSL2)
- **Ansible**: نسخه 2.9+ (`pip install ansible` یا `brew install ansible`)
- **SSH**: کلاینت با احراز هویت کلید یا رمز عبور
- **Python**: نسخه 3.8+ (برای Ansible)

---

## شروع سریع

### ۱. کلون کردن مخزن

<div dir="ltr">

```bash
git clone https://github.com/Iman/javid-mask.git
cd javid-mask/sifter/ansible
```

</div>

### ۲. پیکربندی Inventory

ویرایش `inventory.yml`:

<div dir="ltr">

```yaml
all:
  hosts:
    raspberry_pi:
      ansible_host: 10.0.0.242
      ansible_user: admin
      ansible_python_interpreter: /usr/bin/python3
```

</div>

### ۳. بررسی پیکربندی

ویرایش `group_vars/all.yml`:

<div dir="ltr">

```yaml
# IP ثابت رزبری پای
pi_static_ip: 10.0.0.242
pi_gateway: 10.0.0.1

# تنظیمات Pi-hole
pihole_web_password: "YourSecurePassword"
pihole_dnssec_enabled: true

# ویژگی‌های امنیتی
block_iranian_ips: true
block_iranian_domains: true
ipv6_disabled: true
cloudflared_enabled: true
```

</div>

### ۴. تست اتصال

<div dir="ltr">

```bash
ansible all -i inventory.yml -m ping
```

</div>

### ۵. اجرای استقرار

<div dir="ltr">

```bash
ansible-playbook -i inventory.yml playbook.yml
```

</div>

### ۶. دریافت اعتبارنامه‌ها

<div dir="ltr">

```bash
cat credentials.txt
```

</div>

### ۷. پیکربندی دستگاه‌ها

DNS دستگاه‌هایتان را به `10.0.0.242` تنظیم کنید (به [تنظیم دستگاه‌ها](#تنظیم-دستگاه‌ها) مراجعه کنید).

---

## تنظیم دستگاه‌ها

### گزینه ۱: DHCP روتر (پیشنهادی)

روتر خود را برای توزیع IP پای به عنوان DNS پیکربندی کنید:

۱. به پنل ادمین روتر دسترسی پیدا کنید (معمولاً http://192.168.1.1 یا http://10.0.0.1)
۲. تنظیمات DHCP را پیدا کنید
۳. **سرور DNS** را به `10.0.0.242` تنظیم کنید
۴. ذخیره کنید و روتر را ریبوت کنید
۵. تمام دستگاه‌ها به‌طور خودکار محافظت می‌شوند!

### گزینه ۲: دستی برای هر دستگاه

**ویندوز:**
۱. Settings → Network & Internet → Change adapter options
۲. راست‌کلیک روی آداپتور → Properties
۳. "Internet Protocol Version 4" را انتخاب کنید → Properties
۴. "Use the following DNS server addresses" را انتخاب کنید
۵. وارد کنید: `10.0.0.242`

**macOS:**
۱. System Preferences → Network
۲. اتصال را انتخاب کنید → Advanced → DNS
۳. + را کلیک کنید و اضافه کنید: `10.0.0.242`
۴. سرورهای DNS دیگر را حذف کنید

**iOS:**
۱. Settings → Wi-Fi → (i) کنار شبکه
۲. Configure DNS → Manual
۳. سرورهای موجود را حذف کنید، اضافه کنید: `10.0.0.242`

**Android:**
۱. Settings → Network & Internet → Wi-Fi
۲. روی شبکه نگه دارید → Modify network
۳. Advanced options → IP settings: Static
۴. DNS 1 را تنظیم کنید: `10.0.0.242`

**لینوکس:**

<div dir="ltr">

```bash
# /etc/resolv.conf
nameserver 10.0.0.242
```

</div>

---

## راهنمای سخت‌سازی مرورگر

برای حفاظت کامل، مرورگر خود را پیکربندی کنید:

### Firefox (توصیه شده)

<div dir="ltr">

```
تنظیمات about:config:
├── media.peerconnection.enabled → false     (غیرفعال WebRTC)
├── media.navigator.enabled → false          (غیرفعال دستگاه‌های رسانه)
├── privacy.resistFingerprinting → true      (ضد فینگرپرینتینگ)
├── network.dns.disableIPv6 → true           (غیرفعال DNS IPv6)
├── geo.enabled → false                      (غیرفعال موقعیت‌یابی)
├── dom.battery.enabled → false              (غیرفعال API باتری)
└── privacy.trackingprotection.enabled → true
```

</div>

### افزونه‌های توصیه شده

| افزونه | هدف |
|--------|-----|
| uBlock Origin | مسدودسازی تبلیغ/ردیاب، کنترل WebRTC |
| NoScript | کنترل JavaScript |
| Cookie AutoDelete | پاکسازی خودکار کوکی |
| HTTPS Everywhere | اجبار اتصالات HTTPS |
| Decentraleyes | شبیه‌سازی CDN محلی |

### موبایل (Android)

- استفاده از **Firefox Focus** یا **Brave Browser**
- غیرفعال کردن WebRTC در تنظیمات مرورگر
- استفاده از حالت خصوصی/ناشناس برای مرور حساس

---

## مقایسه MikroTik و رزبری پای

### چرا رزبری پای به جای MikroTik؟

برخی کاربران ممکن است بپرسند آیا روتر MikroTik می‌تواند همان محافظت را فراهم کند. در حالی که MikroTik سخت‌افزار شبکه عالی است، محدودیت‌های حیاتی برای این مورد استفاده حفاظت از حریم خصوصی دارد:

| ویژگی | MikroTik | رزبری پای | برنده |
|-------|----------|------------|-------|
| **مسدودسازی DNS (بیش از ۱.۶ میلیون دامنه)** | ❌ حداکثر ~۱۰۰ هزار | ✅ بیش از ۱.۶ میلیون بدون محدودیت | رزبری پای |
| **مسدودسازی دامنه ایرانی (۱۳۱ هزار+)** | ❌ منابع ناکافی | ✅ کامل | رزبری پای |
| **DNS-over-HTTPS (DoH)** | ⚠️ محدود (فقط v7+) | ✅ کامل (Cloudflared) | رزبری پای |
| **مسدودسازی IP ایرانی (۷۶۳ CIDR)** | ✅ پشتیبانی می‌شود | ✅ پشتیبانی می‌شود | مساوی |
| **ابزارهای مدیریت وب** | ✅ WebFig/WinBox | ✅ پنل Pi-hole | مساوی |
| **مصرف برق** | ✅ ~۵W | ⚠️ ~۱۰-۱۵W | MikroTik |
| **هزینه** | ~۵۰-۱۰۰ دلار | ~۸۰-۱۲۰ دلار (Pi 5 + کارت SD) | مساوی |
| **انعطاف نرم‌افزار** | ⚠️ RouterOS محدود | ✅ لینوکس کامل | رزبری پای |

### محدودیت‌های کلیدی MikroTik

**۱. محدودیت لیست مسدودی DNS**

دستگاه‌های MikroTik دارای محدودیت سخت‌افزاری روی ورودی‌های DNS regex هستند:
- مدل‌های سطح ورودی: ~۱۰,۰۰۰ ورودی
- مدل‌های میان‌رده: ~۵۰,۰۰۰ ورودی
- مدل‌های پیشرفته: ~۱۰۰,۰۰۰ ورودی

مورد استفاده ما نیاز دارد:
- لیست‌های مسدودی Pi-hole: بیش از ۱.۶ میلیون دامنه
- دامنه‌های ایرانی: بیش از ۱۳۱,۵۷۶ دامنه
- **کل**: نیاز به ظرفیت بیش از ۱.۷ میلیون دامنه

**۲. محدودیت‌های DoH**

- فقط RouterOS v7+ از DoH پشتیبانی می‌کند
- پیکربندی پیچیده‌تر از Cloudflared
- عملکرد کمتر تحت بار سنگین

### چه زمانی MikroTik پیشنهاد می‌شود

MikroTik برای موارد زیر مناسب است:
- ✅ فیلترینگ ساده DNS (هزاران دامنه، نه میلیون‌ها)
- ✅ مسیریابی پیشرفته و سوییچینگ
- ✅ مدیریت پهنای باند و QoS
- ✅ شبکه‌های سازمانی
- ✅ پیاده‌سازی‌هایی که فقط به مسدودسازی IP نیاز دارند

برای سناریوی خاص ما (حفاظت هویت استارلینک با فیلترینگ DNS جامع و دامنه‌های ایرانی)، **رزبری پای تنها گزینه عملی است**.

---

## عیب‌یابی

### DNS حل نمی‌شود

<div dir="ltr">

```bash
# بررسی وضعیت Pi-hole
ssh admin@10.0.0.242
pihole status

# بررسی Cloudflared
sudo systemctl status cloudflared

# تست حل DNS
nslookup google.com 10.0.0.242
```

</div>

### دامنه‌های ایرانی مسدود نشده‌اند

<div dir="ltr">

```bash
# تست اگر دامنه مسدود است
nslookup digikala.com 10.0.0.242
# باید 0.0.0.0 برگرداند

# بروزرسانی پایگاه داده gravity
pihole -g
```

</div>

### IPهای ایرانی مسدود نشده‌اند

<div dir="ltr">

```bash
# بررسی وضعیت nftables
sudo systemctl status nftables

# تایید بارگذاری لیست مسدودی
sudo nft list set inet sifter iranian_blocklist | grep -c "/"

# بروزرسانی دستی
sudo /usr/local/bin/update-sifter-firewall.sh
```

</div>

---

## نگهداری

### بروزرسانی سیستم

<div dir="ltr">

```bash
ssh admin@10.0.0.242
sudo apt update && sudo apt upgrade -y
pihole -up
```

</div>

### بروزرسانی لیست‌های مسدودی

<div dir="ltr">

```bash
# بروزرسانی gravity Pi-hole
pihole -g

# بروزرسانی لیست مسدودی IP ایرانی
sudo /usr/local/bin/update-sifter-firewall.sh
```

</div>

### مشاهده لاگ‌ها

<div dir="ltr">

```bash
# لاگ کوئری Pi-hole
sudo journalctl -u pihole-FTL -f

# لاگ Cloudflared
sudo journalctl -u cloudflared -f

# اتصالات ایرانی مسدود شده
sudo journalctl -t kernel --grep=SIFTER_BLOCKED -f
```

</div>

---

## ساختار دایرکتوری

<div dir="ltr">

```
sifter/
├── ansible/
│   ├── inventory.yml
│   ├── playbook.yml
│   ├── group_vars/
│   │   └── all.yml
│   ├── files/
│   │   └── iranian-ips.txt
│   └── roles/
│       ├── prerequisites/
│       ├── network/
│       ├── pihole/
│       ├── cloudflared/
│       └── firewall/
├── diagrams/
│   ├── network-architecture.drawio
│   └── leak-protection.drawio
├── credentials.txt
├── README.md
└── README.fa.md
```

</div>

---

## ملاحظات امنیتی

### آنچه سیفتر در برابرش حفاظت می‌کند

| تهدید | حفاظت |
|-------|-------|
| ثبت کوئری DNS توسط ISP | تمام DNS از طریق DoH رمزشده |
| دسترسی به دامنه ایرانی | بیش از ۱۳۱,۵۷۶ دامنه مسدود |
| اتصالات IP ایرانی | ۷۶۳ رنج CIDR مسدود |
| نشت IPv6 | IPv6 کاملاً غیرفعال |
| همبستگی هویت | نمی‌تواند متصل شود = نمی‌تواند نشت کند |

### آنچه سیفتر در برابرش حفاظت نمی‌کند

| تهدید | دلیل | کاهش |
|-------|------|------|
| تحلیل ترافیک | بدون VPN/رمزگذاری | همه جا از HTTPS استفاده کنید |
| ردیابی IP | IP شما برای سایت‌های غیرایرانی قابل مشاهده است | از VPN یا معماری مثلث استفاده کنید |
| آلودگی نقطه پایانی | بدافزار روی دستگاه | نرم‌افزار امنیت نقطه پایانی |
| فینگرپرینتینگ مرورگر | مبتنی بر JavaScript | مرورگر را پیکربندی کنید (راهنما را ببینید) |

---

## مجوز

مجوز MIT

حق نسخه‌برداری (c) ۲۰۲۶ ایمان سمیع‌زاده

---

## اعتبارات

- **Pi-hole**: https://pi-hole.net/
- **Cloudflared**: https://developers.cloudflare.com/
- **nftables**: https://netfilter.org/projects/nftables/
- **دامنه‌های ایرانی**: https://github.com/bootmortis/iran-hosted-domains
- **IPهای ایرانی**: https://github.com/herrbischoff/country-ip-blocks

---

## وضعیت استقرار

| جزء | وضعیت | جزئیات |
|-----|-------|--------|
| Pi-hole DNS | عملیاتی | بیش از ۱.۶ میلیون دامنه مسدود |
| Cloudflared DoH | عملیاتی | Cloudflare 1.1.1.1 |
| دامنه‌های ایرانی | عملیاتی | بیش از ۱۳۱,۵۷۶ مسدود |
| IPهای ایرانی | عملیاتی | ۷۶۳ رنج CIDR مسدود |
| بلوک IPv6 | عملیاتی | DROP کامل |
| فایروال nftables | عملیاتی | فیلترینگ Stateful |

---

**نگهدارنده**: ایمان سمیع‌زاده
**معماری**: سیفتر (دروازه حفاظت فقط DNS)
**روتر بالادست**: ترمینال استارلینک (یا هر روتری)

</div>
