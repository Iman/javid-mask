<mxfile host="app.diagrams.net" modified="2026-02-01T00:00:00.000Z" agent="5.0" version="22.1.11">
  <diagram name="Leak Protection - Sifter" id="sifter-leak-protection">
    <mxGraphModel dx="1600" dy="1000" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="900" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <!-- Title -->
        <mxCell id="title" value="Sifter: Privacy Threats vs Defence Layers" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalRezagn=middle;whiteSpace=wrap;rounded=0;fontSize=24;fontStyle=1;fontColor=#1a1a1a;" vertex="1" parent="1">
          <mxGeometry x="300" y="20" width="800" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="subtitle" value="DNS-Based Identity Protection for Starlink Users in Iran" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalRezagn=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="300" y="55" width="800" height="25" as="geometry"/>
        </mxCell>

        <!-- Threat Column Header -->
        <mxCell id="threat-header" value="PRIVACY THREAT" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="50" y="100" width="200" height="40" as="geometry"/>
        </mxCell>

        <!-- Status Column Header -->
        <mxCell id="status-header" value="STATUS" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="270" y="100" width="120" height="40" as="geometry"/>
        </mxCell>

        <!-- Defence Column Header -->
        <mxCell id="defence-header" value="SIFTER DEFENCE" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="410" y="100" width="300" height="40" as="geometry"/>
        </mxCell>

        <!-- Layer Column Header -->
        <mxCell id="layer-header" value="LAYER" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="730" y="100" width="120" height="40" as="geometry"/>
        </mxCell>

        <!-- Row 1: DNS Leak -->
        <mxCell id="threat-dns" value="DNS Leak&#10;(ISP sees your queries)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5c6c6;strokeColor=#b85450;fontSize=11;align=center" vertex="1" parent="1">
          <mxGeometry x="50" y="160" width="200" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="status-dns" value="✅ PROTECTED" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="270" y="160" width="120" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="defence-dns" value="Pi-hole → Cloudflared DoH&#10;All DNS encrypted to Cloudflare 1.1.1.1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#82b366;fontSize=10;align=left;spacingLeft=10" vertex="1" parent="1">
          <mxGeometry x="410" y="160" width="300" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="layer-dns" value="Network&#10;(Automatic)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#b4d7e8;strokeColor=#6c8ebf;fontSize=10" vertex="1" parent="1">
          <mxGeometry x="730" y="160" width="120" height="50" as="geometry"/>
        </mxCell>

        <!-- Row 2: IPv6 Leak -->
        <mxCell id="threat-ipv6" value="IPv6 Leak&#10;(Bypasses IPv4 protections)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5c6c6;strokeColor=#b85450;fontSize=11;align=center" vertex="1" parent="1">
          <mxGeometry x="50" y="230" width="200" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="status-ipv6" value="✅ PROTECTED" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="270" y="230" width="120" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="defence-ipv6" value="IPv6 completely disabled at kernel level&#10;nftables: DROP all ip6 traffic" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#82b366;fontSize=10;align=left;spacingLeft=10" vertex="1" parent="1">
          <mxGeometry x="410" y="230" width="300" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="layer-ipv6" value="Network&#10;(Automatic)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#b4d7e8;strokeColor=#6c8ebf;fontSize=10" vertex="1" parent="1">
          <mxGeometry x="730" y="230" width="120" height="50" as="geometry"/>
        </mxCell>

        <!-- Row 3: Iranian Domain Leak -->
        <mxCell id="threat-ir-domain" value="Iranian Domain Access&#10;(Identity correlation)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5c6c6;strokeColor=#b85450;fontSize=11;align=center" vertex="1" parent="1">
          <mxGeometry x="50" y="300" width="200" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="status-ir-domain" value="✅ PROTECTED" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="270" y="300" width="120" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="defence-ir-domain" value="Pi-hole blocks 131,576+ Iranian domains&#10;bootmortis + liketolivefree lists + *.ir regex" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#82b366;fontSize=10;align=left;spacingLeft=10" vertex="1" parent="1">
          <mxGeometry x="410" y="300" width="300" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="layer-ir-domain" value="Network&#10;(Automatic)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#b4d7e8;strokeColor=#6c8ebf;fontSize=10" vertex="1" parent="1">
          <mxGeometry x="730" y="300" width="120" height="50" as="geometry"/>
        </mxCell>

        <!-- Row 4: Iranian IP Leak -->
        <mxCell id="threat-ir-ip" value="Iranian IP Connection&#10;(Direct IP access)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5c6c6;strokeColor=#b85450;fontSize=11;align=center" vertex="1" parent="1">
          <mxGeometry x="50" y="370" width="200" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="status-ir-ip" value="✅ PROTECTED" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="270" y="370" width="120" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="defence-ir-ip" value="nftables blocks 763 Iranian CIDR ranges&#10;All Iranian ISPs: MCI, Irancell, Rightel, etc." style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#82b366;fontSize=10;align=left;spacingLeft=10" vertex="1" parent="1">
          <mxGeometry x="410" y="370" width="300" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="layer-ir-ip" value="Network&#10;(Automatic)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#b4d7e8;strokeColor=#6c8ebf;fontSize=10" vertex="1" parent="1">
          <mxGeometry x="730" y="370" width="120" height="50" as="geometry"/>
        </mxCell>

        <!-- Row 5: Cookie Correlation -->
        <mxCell id="threat-cookie" value="Cookie Correlation&#10;(Iranian site sees identity)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5c6c6;strokeColor=#b85450;fontSize=11;align=center" vertex="1" parent="1">
          <mxGeometry x="50" y="440" width="200" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="status-cookie" value="✅ PROTECTED" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="270" y="440" width="120" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="defence-cookie" value="Cannot connect to Iranian servers = cannot send cookies&#10;Domain + IP blocking prevents any connection" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#82b366;fontSize=10;align=left;spacingLeft=10" vertex="1" parent="1">
          <mxGeometry x="410" y="440" width="300" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="layer-cookie" value="Network&#10;(Automatic)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#b4d7e8;strokeColor=#6c8ebf;fontSize=10" vertex="1" parent="1">
          <mxGeometry x="730" y="440" width="120" height="50" as="geometry"/>
        </mxCell>

        <!-- Row 6: WebRTC Leak -->
        <mxCell id="threat-webrtc" value="WebRTC Leak&#10;(IP exposed via browser)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5c6c6;strokeColor=#b85450;fontSize=11;align=center" vertex="1" parent="1">
          <mxGeometry x="50" y="510" width="200" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="status-webrtc" value="⚠️ USER CONFIG" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="270" y="510" width="120" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="defence-webrtc" value="Requires browser configuration&#10;Firefox: media.peerconnection.enabled = false" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;align=left;spacingLeft=10" vertex="1" parent="1">
          <mxGeometry x="410" y="510" width="300" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="layer-webrtc" value="Browser&#10;(User Action)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=10" vertex="1" parent="1">
          <mxGeometry x="730" y="510" width="120" height="50" as="geometry"/>
        </mxCell>

        <!-- Row 7: Browser Fingerprint -->
        <mxCell id="threat-fingerprint" value="Browser Fingerprint&#10;(Canvas, WebGL, fonts)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5c6c6;strokeColor=#b85450;fontSize=11;align=center" vertex="1" parent="1">
          <mxGeometry x="50" y="580" width="200" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="status-fingerprint" value="⚠️ USER CONFIG" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="270" y="580" width="120" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="defence-fingerprint" value="Requires browser configuration&#10;Firefox: privacy.resistFingerprinting = true" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;align=left;spacingLeft=10" vertex="1" parent="1">
          <mxGeometry x="410" y="580" width="300" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="layer-fingerprint" value="Browser&#10;(User Action)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=10" vertex="1" parent="1">
          <mxGeometry x="730" y="580" width="120" height="50" as="geometry"/>
        </mxCell>

        <!-- Legend -->
        <mxCell id="legend-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="900" y="100" width="450" height="250" as="geometry"/>
        </mxCell>
        <mxCell id="legend-title" value="SIFTER PROTECTION LEGEND" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalRezagn=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="1000" y="110" width="250" height="25" as="geometry"/>
        </mxCell>

        <mxCell id="legend-auto" value="Network Layer (Automatic)&#10;Protected automatically by Sifter&#10;No user action required" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#b4d7e8;strokeColor=#6c8ebf;fontSize=10;align=left;spacingLeft=10" vertex="1" parent="1">
          <mxGeometry x="920" y="145" width="200" height="55" as="geometry"/>
        </mxCell>

        <mxCell id="legend-browser" value="Browser Layer (User Config)&#10;Requires browser settings change&#10;See README for instructions" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=10;align=left;spacingLeft=10" vertex="1" parent="1">
          <mxGeometry x="920" y="210" width="200" height="55" as="geometry"/>
        </mxCell>

        <mxCell id="legend-protected" value="✅ PROTECTED" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="1140" y="145" width="100" height="30" as="geometry"/>
        </mxCell>

        <mxCell id="legend-user" value="⚠️ USER CONFIG" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="1140" y="185" width="100" height="30" as="geometry"/>
        </mxCell>

        <mxCell id="legend-stats" value="Sifter Statistics:&#10;• DNS Domains Blocked: 1.6M+&#10;• Iranian Domains: 131,576+&#10;• Iranian IP Ranges: 763 CIDRs&#10;• IPv6: Completely Disabled" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalRezagn=top;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#333333;spacingLeft=10" vertex="1" parent="1">
          <mxGeometry x="1130" y="225" width="200" height="90" as="geometry"/>
        </mxCell>

        <!-- Key Difference Note -->
        <mxCell id="note-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="900" y="370" width="450" height="260" as="geometry"/>
        </mxCell>
        <mxCell id="note-title" value="SIFTER vs SINGLETON vs TRIANGLE" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalRezagn=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1;fontColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="1000" y="380" width="250" height="20" as="geometry"/>
        </mxCell>
        <mxCell id="note-content" value="SIFTER (This Project):&#10;• DNS Server Only - no WiFi AP, no VPN&#10;• All home devices point DNS to Pi&#10;• Simplest setup, focused protection&#10;• Perfect for blocking Iranian services&#10;&#10;SINGLETON:&#10;• WiFi AP + Proxy (VLESS/VMess)&#10;• Isolated network for connected devices&#10;• More complex, more features&#10;&#10;TRIANGLE:&#10;• WiFi AP + WireGuard VPN to VPS&#10;• All traffic exits from VPS IP&#10;• Most complex, most protection" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalRezagn=top;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#333333;spacingLeft=15;spacingTop=10" vertex="1" parent="1">
          <mxGeometry x="910" y="405" width="430" height="220" as="geometry"/>
        </mxCell>

        <!-- Copyright -->
        <mxCell id="copyright" value="© 2026 Iman Samizadeh | MIT License | javid-mask Project | Sifter Architecture" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalRezagn=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="300" y="680" width="800" height="25" as="geometry"/>
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
